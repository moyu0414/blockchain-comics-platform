{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link}from\"react-router-dom\";import{Container,Col,Row,Image,Button}from'react-bootstrap';import'./bootstrap.min.css';import{useTranslation}from'react-i18next';import i18n from'../i18n';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const website=process.env.REACT_APP_Website;const API_KEY=process.env.REACT_APP_API_KEY;function CreateSuccess(){const[comic,setComic]=useState([]);const[loading,setLoading]=useState(true);const{t}=useTranslation();const uploadComicData=localStorage.getItem(\"uploadComicData\");const uploadArray=JSON.parse(uploadComicData);const currentAccount=localStorage.getItem(\"currentAccount\");const headers={'api-key':API_KEY};let temp=[];const initData=async()=>{try{const comicHash=Object.keys(uploadArray)[0];const chapterTitle=uploadArray[comicHash];let found=false;while(!found){const storedArrayJSON=localStorage.getItem('comicDatas');const storedArray=JSON.parse(storedArrayJSON);for(let i=0;i<storedArray.length;i++){if(comicHash===storedArray[i].comic_id){const imageResponse=await axios.get(\"\".concat(website,\"/api/comicIMG/\").concat(comicHash),{responseType:'blob',headers});const image=URL.createObjectURL(imageResponse.data);temp.push({comicID:storedArray[i].comicID,title:storedArray[i].title,image:image,chapter:chapterTitle});found=true;// 找到匹配的 comicHash，可以退出循环\nbreak;}}if(!found){await new Promise(resolve=>setTimeout(resolve,1000));// 等待1秒钟再尝试\n}}//console.log(temp);\nsetComic(temp);setLoading(false);}catch(error){console.error('Error initializing contract:',error);}};useEffect(()=>{initData();},[currentAccount]);const handleCreator=()=>{window.location.replace(\"/creatorPage\");};const handleMGMT=()=>{window.location.replace(\"/manageComic\");};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{children:[!loading&&/*#__PURE__*/_jsxs(Container,{className:\"createSuccess\",children:[/*#__PURE__*/_jsx(Row,{className:\"pt-4\",children:/*#__PURE__*/_jsxs(Link,{to:\"/comicDetail/\".concat(comic[0].comicID),children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-block mx-auto img-fluid createSuccess-image-container\",children:/*#__PURE__*/_jsx(\"img\",{className:\"d-block mx-auto img-fluid\",src:comic[0].image,alt:\"800x400\"})}),/*#__PURE__*/_jsx(\"h5\",{className:\"text-center pt-2 pb-1\",children:comic[0].title}),/*#__PURE__*/_jsx(\"h5\",{className:\"text-center pb-3\",children:comic[0].chapter})]})}),/*#__PURE__*/_jsx(Row,{className:\"justify-content-center text-center w-100\",children:/*#__PURE__*/_jsxs(Col,{xs:12,md:8,children:[/*#__PURE__*/_jsx(Image,{src:\"/Emoji.png\",alt:\"\\u5716\\u7247\",fluid:true,rounded:true,className:\"mb-4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"h4\",{children:t('漫畫成功上傳')})}),/*#__PURE__*/_jsx(Button,{onClick:handleCreator,style:{marginRight:\"15px\"},children:t('創作者專區')}),/*#__PURE__*/_jsx(Button,{onClick:handleMGMT,children:t('管理漫畫')})]})})]}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading-container\",children:/*#__PURE__*/_jsx(\"div\",{children:t('頁面加載中')})})]})});}export default CreateSuccess;","map":{"version":3,"names":["React","useState","useEffect","Link","Container","Col","Row","Image","Button","useTranslation","i18n","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","website","process","env","REACT_APP_Website","API_KEY","REACT_APP_API_KEY","CreateSuccess","comic","setComic","loading","setLoading","t","uploadComicData","localStorage","getItem","uploadArray","JSON","parse","currentAccount","headers","temp","initData","comicHash","Object","keys","chapterTitle","found","storedArrayJSON","storedArray","i","length","comic_id","imageResponse","get","concat","responseType","image","URL","createObjectURL","data","push","comicID","title","chapter","Promise","resolve","setTimeout","error","console","handleCreator","window","location","replace","handleMGMT","children","className","to","src","alt","xs","md","fluid","rounded","onClick","style","marginRight"],"sources":["C:/Users/user1/Desktop/blockchain-comics-platform/frontend/src/routes/createSuccess.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Link } from \"react-router-dom\";\r\nimport { Container, Col, Row, Image, Button } from 'react-bootstrap';\r\nimport './bootstrap.min.css';\r\nimport { useTranslation } from 'react-i18next';\r\nimport i18n from '../i18n';\r\nimport axios from 'axios';\r\nconst website = process.env.REACT_APP_Website;\r\nconst API_KEY = process.env.REACT_APP_API_KEY;\r\n\r\nfunction CreateSuccess() {\r\n    const [comic, setComic] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const { t } = useTranslation();\r\n    const uploadComicData = localStorage.getItem(\"uploadComicData\");\r\n    const uploadArray = JSON.parse(uploadComicData);\r\n    const currentAccount = localStorage.getItem(\"currentAccount\");\r\n    const headers = {'api-key': API_KEY};\r\n    let temp = [];\r\n\r\n    const initData = async () => {\r\n        try {\r\n            const comicHash = Object.keys(uploadArray)[0];\r\n            const chapterTitle = uploadArray[comicHash];\r\n            let found = false;\r\n            while (!found) {\r\n                const storedArrayJSON = localStorage.getItem('comicDatas');\r\n                const storedArray = JSON.parse(storedArrayJSON);\r\n                for (let i = 0; i < storedArray.length; i++) {\r\n                    if (comicHash === storedArray[i].comic_id) {\r\n                        const imageResponse = await axios.get(`${website}/api/comicIMG/${comicHash}`, { responseType: 'blob', headers });\r\n                        const image = URL.createObjectURL(imageResponse.data);\r\n                        temp.push({\r\n                            comicID: storedArray[i].comicID,\r\n                            title: storedArray[i].title,\r\n                            image: image,\r\n                            chapter: chapterTitle\r\n                        });\r\n                        found = true; // 找到匹配的 comicHash，可以退出循环\r\n                        break;\r\n                    }\r\n                }\r\n                if (!found) {\r\n                    await new Promise(resolve => setTimeout(resolve, 1000)); // 等待1秒钟再尝试\r\n                }\r\n            }\r\n            //console.log(temp);\r\n            setComic(temp);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('Error initializing contract:', error);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        initData();\r\n    }, [currentAccount]);\r\n\r\n    const handleCreator = () => {\r\n        window.location.replace(\"/creatorPage\");\r\n    };\r\n\r\n    const handleMGMT = () => {\r\n        window.location.replace(\"/manageComic\");\r\n    };\r\n\r\n\r\n    return (\r\n        <>\r\n            <div>\r\n                {!loading &&\r\n                    <Container className='createSuccess'>\r\n                        {/* 此處會放上該漫畫的封面+名稱供預覽 跟創作者頁面creatorPage的一樣*/}\r\n                        <Row className=\"pt-4\">\r\n                            <Link to={`/comicDetail/${comic[0].comicID}`}>\r\n                                <div className=\"d-block mx-auto img-fluid createSuccess-image-container\">\r\n                                    <img\r\n                                        className=\"d-block mx-auto img-fluid\"\r\n                                        src={comic[0].image}\r\n                                        alt=\"800x400\"\r\n                                    />\r\n                                </div>\r\n                                <h5 className='text-center pt-2 pb-1'>{comic[0].title}</h5>\r\n                                <h5 className='text-center pb-3'>{comic[0].chapter}</h5>\r\n                            </Link>\r\n                        </Row>\r\n                        <Row className=\"justify-content-center text-center w-100\">\r\n                            <Col xs={12} md={8}>\r\n                                <Image \r\n                                    src=\"/Emoji.png\" \r\n                                    alt=\"圖片\" \r\n                                    fluid \r\n                                    rounded \r\n                                    className=\"mb-4\" \r\n                                />\r\n                            <div className=\"mb-3\">\r\n                                <h4>{t('漫畫成功上傳')}</h4>\r\n                            </div>\r\n                            <Button onClick={handleCreator} style={{marginRight: \"15px\"}}>{t('創作者專區')}</Button>\r\n                            <Button onClick={handleMGMT}>{t('管理漫畫')}</Button>\r\n                            </Col>\r\n                        </Row>\r\n                    </Container>\r\n                }\r\n                {loading &&  \r\n                    <div className=\"loading-container\">\r\n                        <div>{t('頁面加載中')}</div>\r\n                    </div>\r\n                }\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default CreateSuccess;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}