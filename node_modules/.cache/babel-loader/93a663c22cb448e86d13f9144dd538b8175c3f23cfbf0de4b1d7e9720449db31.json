{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import{Container,Card,Col,Row}from'react-bootstrap';import'./bootstrap.min.css';import{Funnel}from'react-bootstrap-icons';import{useTranslation}from'react-i18next';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const website=process.env.REACT_APP_Website;const API_KEY=process.env.REACT_APP_API_KEY;function CollectionPage(){const[comic,setComic]=useState([]);const[loading,setLoading]=useState(true);const[beingComic,setBeingComic]=useState(true);const{t}=useTranslation();const storedArrayJSON=localStorage.getItem('comicDatas');const currentAccount=localStorage.getItem(\"currentAccount\");const headers={'api-key':API_KEY};let temp=[];const initData=async()=>{try{const response=await axios.get(\"\".concat(website,\"/api/comicDetail/isFavorited\"),{headers:headers,params:{currentAccount:currentAccount}});const collectComicSet=new Set(response.data.collectComic.split(',').map(id=>id.trim()));try{const storedArray=JSON.parse(storedArrayJSON);const temp=storedArray.filter(item=>item.is_exist===0&&collectComicSet.has(item.comic_id)).map(async item=>{try{const imageResponse=await axios.get(\"\".concat(website,\"/api/comicIMG/\").concat(item.comic_id),{responseType:'blob',headers});const imageUrl=URL.createObjectURL(imageResponse.data);return{comicID:item.comicID,title:item.title,category:item.category,image:imageUrl};}catch(error){console.error(\"Error fetching image for \".concat(item.title,\": \").concat(error.message));}});Promise.all(temp).then(results=>{const filteredResults=results.filter(result=>result!==null);//console.log(filteredResults);\nsetComic(filteredResults);if(filteredResults.length===0){setBeingComic(false);}setLoading(false);}).catch(error=>{console.error(\"Error processing stored data: \".concat(error.message));});}catch(error){console.error('Error initializing comic:',error);}}catch(error){console.error('Error fetching records:',error);}};useEffect(()=>{initData();},[currentAccount]);return/*#__PURE__*/_jsx(_Fragment,{children:!loading?/*#__PURE__*/_jsxs(Container,{className:\"creatorPage\",children:[/*#__PURE__*/_jsx(Row,{className:\"pt-5\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"fw-bold\",children:t('已收藏漫畫')})}),!beingComic&&/*#__PURE__*/_jsx(Row,{className:\"pt-5 justify-content-center\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"fw-bold text-center\",children:t('目前尚未收藏漫畫')})}),/*#__PURE__*/_jsx(Row,{xs:1,md:2,className:\"g-4 pb-5\",children:comic.map((data,idx)=>/*#__PURE__*/_jsx(Col,{xs:4,md:3,className:\"pt-2\",children:/*#__PURE__*/_jsx(Link,{to:\"/comicDetail/\".concat(data.comicID),children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"position-relative\",children:[/*#__PURE__*/_jsx(Card.Img,{variant:\"top\",src:data.image}),/*#__PURE__*/_jsx(\"div\",{className:\"category-overlay\",children:t(data.category)})]}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsx(Card.Title,{className:\"text-center\",children:data.title})})]})})},idx))})]}):/*#__PURE__*/_jsx(\"div\",{className:\"loading-container\",children:/*#__PURE__*/_jsx(\"div\",{children:t('頁面加載中')})})});}export default CollectionPage;","map":{"version":3,"names":["React","useState","useEffect","Link","Container","Card","Col","Row","Funnel","useTranslation","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","website","process","env","REACT_APP_Website","API_KEY","REACT_APP_API_KEY","CollectionPage","comic","setComic","loading","setLoading","beingComic","setBeingComic","t","storedArrayJSON","localStorage","getItem","currentAccount","headers","temp","initData","response","get","concat","params","collectComicSet","Set","data","collectComic","split","map","id","trim","storedArray","JSON","parse","filter","item","is_exist","has","comic_id","imageResponse","responseType","imageUrl","URL","createObjectURL","comicID","title","category","image","error","console","message","Promise","all","then","results","filteredResults","result","length","catch","children","className","xs","md","idx","to","Img","variant","src","Body","Title"],"sources":["C:/Users/user1/Desktop/blockchain-comics-platform/frontend/src/routes/collectionPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { Container, Card, Col, Row } from 'react-bootstrap';\r\nimport './bootstrap.min.css';\r\nimport { Funnel } from 'react-bootstrap-icons';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axios from 'axios';\r\nconst website = process.env.REACT_APP_Website;\r\nconst API_KEY = process.env.REACT_APP_API_KEY;\r\n\r\nfunction CollectionPage() {\r\n    const [comic, setComic] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [beingComic, setBeingComic] = useState(true);\r\n    const { t } = useTranslation();\r\n    const storedArrayJSON = localStorage.getItem('comicDatas');\r\n    const currentAccount = localStorage.getItem(\"currentAccount\");\r\n    const headers = {'api-key': API_KEY};\r\n    let temp = [];\r\n\r\n    const initData = async () => {\r\n        try {\r\n            const response = await axios.get(`${website}/api/comicDetail/isFavorited`, {\r\n                headers: headers,\r\n                params: {\r\n                    currentAccount: currentAccount,\r\n                }\r\n            });\r\n            const collectComicSet = new Set(response.data.collectComic.split(',').map(id => id.trim()));\r\n            try {\r\n                const storedArray = JSON.parse(storedArrayJSON);\r\n                const temp = storedArray\r\n                    .filter(item => item.is_exist === 0 && collectComicSet.has(item.comic_id))\r\n                    .map(async item => {\r\n                        try {\r\n                            const imageResponse = await axios.get(`${website}/api/comicIMG/${item.comic_id}`, { responseType: 'blob', headers });\r\n                            const imageUrl = URL.createObjectURL(imageResponse.data);\r\n                            return {\r\n                                comicID: item.comicID,\r\n                                title: item.title,\r\n                                category: item.category,\r\n                                image: imageUrl\r\n                            };\r\n                        } catch (error) {\r\n                            console.error(`Error fetching image for ${item.title}: ${error.message}`);\r\n                        }\r\n                    });\r\n                Promise.all(temp)\r\n                    .then(results => {\r\n                        const filteredResults = results.filter(result => result !== null);\r\n                        //console.log(filteredResults);\r\n                        setComic(filteredResults);\r\n                        if (filteredResults.length === 0) {\r\n                            setBeingComic(false);\r\n                        }\r\n                        setLoading(false);\r\n                    })\r\n                    .catch(error => {\r\n                        console.error(`Error processing stored data: ${error.message}`);\r\n                    });\r\n            } catch (error) {\r\n                console.error('Error initializing comic:', error);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching records:', error);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        initData();\r\n    }, [currentAccount]);\r\n\r\n\r\n    return (\r\n        <>\r\n            {!loading ? (\r\n                <Container className='creatorPage'>\r\n                    <Row className='pt-5'>\r\n                        <h3 className=\"fw-bold\">{t('已收藏漫畫')}</h3>\r\n                    </Row>\r\n                    {!beingComic &&  \r\n                        <Row className='pt-5 justify-content-center'>\r\n                            <h1 className=\"fw-bold text-center\">{t('目前尚未收藏漫畫')}</h1>\r\n                        </Row>\r\n                    }\r\n                    <Row xs={1} md={2} className=\"g-4 pb-5\">\r\n                        {comic.map((data, idx) => (\r\n                            <Col key={idx} xs={4} md={3} className=\"pt-2\">\r\n                                <Link to={`/comicDetail/${data.comicID}`}>\r\n                                    <Card>\r\n                                        <div className=\"position-relative\">\r\n                                            <Card.Img variant=\"top\" src={data.image} />\r\n                                            <div className=\"category-overlay\">{t(data.category)}</div>\r\n                                        </div>\r\n                                        <Card.Body>\r\n                                            <Card.Title className='text-center'>{data.title}</Card.Title>\r\n                                        </Card.Body>\r\n                                    </Card>\r\n                                </Link>\r\n                            </Col>\r\n                        ))}\r\n                    </Row>\r\n                </Container>\r\n            ) : (\r\n                <div className=\"loading-container\">\r\n                <div>{t('頁面加載中')}</div>\r\n                </div>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n\r\nexport default CollectionPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}