{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{Link,useParams}from\"react-router-dom\";import{Navbar,Container,Row,Col,Table,ButtonToolbar,Pagination}from'react-bootstrap';import{ChevronLeft,List,ChevronDoubleLeft,ChevronRight,ChevronDoubleRight}from'react-bootstrap-icons';import{useSwipeable}from'react-swipeable';import{message}from'antd';import comicData from'../contracts/ComicPlatform.json';import Web3 from'web3';import{useTranslation}from'react-i18next';import i18n from'../i18n';import axios from'axios';import{sortByTimestamp,getTransactionTimestamp,disableAllButtons,enableAllButtons,initializeWeb3}from'../index';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const website=process.env.REACT_APP_Website;const API_KEY=process.env.REACT_APP_API_KEY;const ComicRead=()=>{var _chapter$,_chapter$2,_currentChapters$,_currentChapters$2;const[showNavbar,setShowNavbar]=useState(true);const[showIconBar,setShowIconBar]=useState(true);const lastScrollTop=useRef(0);const[showOverlay,setShowOverlay]=useState(false);const[comic,setComic]=useState([]);const[allChapters,setAllChapters]=useState([]);const[chapter,setChapter]=useState([]);const[splitImages,setSplitImages]=useState([]);const[autoMode,setAutoMode]=useState(true);const[pageMode,setPageMode]=useState('');const{comicID,chapterID}=useParams();const[loading,setLoading]=useState(true);const[currentPage,setCurrentPage]=useState(1);const[readPage,setReadPage]=useState(0);const itemsPerPage=10;// 每頁顯示的章節數量\nconst{t}=useTranslation();const storedArrayJSON=localStorage.getItem('comicDatas');const currentAccount=localStorage.getItem(\"currentAccount\");const[readingProgress,setReadingProgress]=useState(()=>{const savedProgress=localStorage.getItem('readingProgress');return savedProgress?JSON.parse(savedProgress):{};});const headers={'api-key':API_KEY};const fetchedData=[];let temp=[];let read=[];const handleScroll=()=>{const currentScrollTop=window.pageYOffset||document.documentElement.scrollTop;if(currentScrollTop>lastScrollTop.current){// 向下滚动\nsetShowNavbar(false);setShowIconBar(false);}else{// 向上滚动\nsetShowNavbar(true);setShowIconBar(true);}lastScrollTop.current=currentScrollTop<=0?0:currentScrollTop;};const handleClick=()=>{setShowNavbar(prevState=>!prevState);setShowIconBar(prevState=>!prevState);};const handleListClick=()=>{setShowOverlay(true);};const handleCloseOverlay=()=>{setShowOverlay(false);};useEffect(()=>{window.addEventListener('scroll',handleScroll);return()=>{window.removeEventListener('scroll',handleScroll);};},[]);const handlePageChange=page=>{setCurrentPage(page);};const initData=async()=>{try{const storedArray=JSON.parse(storedArrayJSON);for(var i=0;i<storedArray.length;i++){if(storedArray[i].comicID==comicID){temp.push(storedArray[i]);};};setComic(temp);// 本漫畫的所有章節是否購買\ntry{const response=await axios.get(`${website}/api/comicRead`,{headers:headers,params:{comicHash:temp[0].comic_id,currentAccount:currentAccount}});let records=response.data;sortByTimestamp(records);records=records.map((chapter,index)=>{let isBuying,creator,chapterPrice;if(chapter.creator===currentAccount){isBuying=t('閱讀');creator=t('您是本作品的創作者');if(chapter.chapterPrice==0){chapterPrice=t('免費');}else{chapterPrice=chapter.chapterPrice;}}else if(chapter.chapterPrice==0){isBuying=t('閱讀');creator=chapter.creator;chapterPrice=t('免費');}else{isBuying=t(chapter.isBuying);creator=chapter.creator;chapterPrice=chapter.chapterPrice;}return{...chapter,chapterID:`chapter${index+1}`,isBuying,creator,chapterPrice};});setAllChapters(records);for(var i=0;i<records.length;i++){if(records[i].chapterID===chapterID&&records[i].isBuying===t('閱讀')){const chapterResponse=await axios.get(`${website}/api/chapterIMG/${records[i].chapterHash}`,{responseType:'blob',headers});const image=URL.createObjectURL(chapterResponse.data);const img=new Image();img.src=image;img.crossOrigin='Anonymous';// 避免 CORS 问题\nawait new Promise(resolve=>{img.onload=resolve;});if(autoMode){if(img.width>=1200){setSplitImages(processImage(img));setPageMode(true);}else{setPageMode(false);}}else if(pageMode){setSplitImages(processImage(img));}read.push({chapterTitle:records[i].chapterTitle,chapterID:chapterID,num:i+1,image:image});}}setChapter(read);setLoading(false);}catch(error){console.error('Error fetching records:',error);}}catch(error){console.error('Error initializing contract:',error);}};useEffect(()=>{initData();setReadingProgress(prevProgress=>{const newProgress={...prevProgress,[comicID]:chapterID};localStorage.setItem('readingProgress',JSON.stringify(newProgress));return newProgress;});},[comicID,chapterID,autoMode]);const processImage=img=>{const splitWidth=1200;const numSplits=Math.ceil(img.width/splitWidth);const canvas=document.createElement('canvas');const context=canvas.getContext('2d');const newSplitImages=[];for(let i=0;i<numSplits;i++){canvas.width=splitWidth;canvas.height=img.height;context.clearRect(0,0,canvas.width,canvas.height);context.drawImage(img,-i*splitWidth,0);const splitImageURL=canvas.toDataURL('image/png');newSplitImages.push({id:i+1,image:splitImageURL});};return newSplitImages;};// 章節購買 或 閱讀函數\nconst handlePurchase=async chapterId=>{const chapter=currentChapters[chapterId];// 使用傳遞進來的索引值來訪問章節資料\nconst operationValue=chapter.isBuying;if(operationValue===t('閱讀')){window.location.href=`/comicRead/${comicID}/${chapter.chapterID}`;}else{try{disableAllButtons();const web3=await initializeWeb3(t);if(!web3){return;}const web3Instance=new web3.eth.Contract(comicData.abi,comicData.address);const accounts=await web3.eth.getAccounts();const account=accounts[0];if(account){let balance=await web3.eth.getBalance(currentAccount);balance=balance.toString()/1e18;let price=chapter.chapterPrice;if(balance>price){const comicHash=comic[0].comic_id;const chapterHash=chapter.chapterHash;//console.log(comicHash);\n//console.log(comic[0].creator);\n//console.log(chapterHash);\n//console.log(price);\nprice=web3.utils.toWei(price,'ether');let gasEstimate=await web3Instance.methods.purchaseChapter(comicHash,chapterHash,price/10).estimateGas({from:currentAccount,value:price});const transaction=await web3Instance.methods.purchaseChapter(comicHash,chapterHash,gasEstimate).send({from:currentAccount,value:price,gas:gasEstimate});const transactionHash=transaction.transactionHash;let Timestamp=await getTransactionTimestamp(transactionHash);const author=comic[0].creator;const formData=new FormData();formData.append('hash',transactionHash);formData.append('comic_id',comicHash);formData.append('chapter_id',chapterHash);formData.append('buyer',currentAccount);formData.append('creator',author);formData.append('purchase_date',Timestamp);formData.append('price',chapter.chapterPrice);try{const response=await axios.post(`${website}/api/add/records`,formData,{headers:{'Content-Type':'multipart/form-data','api-key':API_KEY}});message.info(t('章節購買成功'));const updatedChapters=[...currentChapters];updatedChapters[chapterId].isBuying=t('閱讀');// 更新章節的購買狀態\nsetAllChapters(updatedChapters);}catch(error){console.error('購買紀錄添加至資料庫時發生錯誤：',error);}}else{message.info(t('餘額不足'));}}else{alert(t('請先登入以太坊錢包，再進行購買'));return;}}catch(error){if(error.message.includes('User denied transaction signature')){alert(t('拒绝交易'));}else{console.error('章節購買時發生錯誤：',error);alert(error);window.location.reload();}}finally{enableAllButtons();}}};const handleClickLeft=()=>{const total=allChapters.length.toString();let id=parseInt(chapterID.replace(\"chapter\",\"\"),10);if(total==1){message.info(t('目前只有這個章節'));return;}else if(allChapters[id-2]){if(allChapters[id-2].isBuying===t('閱讀')){window.location.replace(`/comicRead/${comicID}/chapter${id-1}`);}else{message.info(t('您尚未購買第幾章節',{id:id-1}));return;}}else{message.info(t('本章節為第一章'));return;}};const handleClickRight=()=>{const total=allChapters.length.toString();let id=parseInt(chapterID.replace(\"chapter\",\"\"),10);if(total==1){message.info(t('目前只有這個章節'));return;}else if(allChapters[id]){if(allChapters[id].isBuying===t('閱讀')){window.location.replace(`/comicRead/${comicID}/chapter${id+1}`);}else{message.info(t('您尚未購買第幾章節',{id:id+1}));return;}}else{message.info(t('本章節為最新章'));return;}};const handlePrev=()=>{if(readPage>0){setReadPage(readPage-1);}else if(readPage==0){message.info(t('此為第一頁'));}};const handleNext=()=>{if(readPage<splitImages.length-1){setReadPage(readPage+1);}else if(readPage==splitImages.length-1){message.info(t('本章節已閱讀完'));}};const swipeHandlers=useSwipeable({onSwipedLeft:handleNext,onSwipedRight:handlePrev,preventDefaultTouchmoveEvent:true,trackMouse:true});const toggleMode=()=>{setPageMode(prevMode=>!prevMode);setAutoMode(false);};const totalPages=Math.ceil(allChapters.length/itemsPerPage);const startIndex=(currentPage-1)*itemsPerPage;const currentChapters=allChapters.slice(startIndex,startIndex+itemsPerPage);const getPageItems=()=>{const pageItems=[];const maxPagesToShow=5;// 顯示的最大頁碼數量\nif(totalPages<=maxPagesToShow){// 如果總頁數小於等於最大顯示頁碼數，則顯示所有頁碼\nfor(let i=1;i<=totalPages;i++){pageItems.push(/*#__PURE__*/_jsx(Pagination.Item,{active:i===currentPage,onClick:()=>handlePageChange(i),children:i},i));}}else{// 計算中間的頁碼範圍\nconst middlePages=Math.floor(maxPagesToShow/2);let startPage=Math.max(2,currentPage-middlePages);let endPage=Math.min(totalPages-1,currentPage+middlePages);if(currentPage-startPage<=middlePages){endPage=Math.min(totalPages-1,startPage+maxPagesToShow-2);}if(endPage-currentPage<=middlePages){startPage=Math.max(2,endPage-maxPagesToShow+2);}// 第一頁\npageItems.push(/*#__PURE__*/_jsx(Pagination.Item,{active:currentPage===1,onClick:()=>handlePageChange(1),children:\"1\"},1));if(startPage>2){pageItems.push(/*#__PURE__*/_jsx(Pagination.Ellipsis,{},\"ellipsis-start\"));}// 中間的頁碼\nfor(let i=startPage;i<=endPage;i++){pageItems.push(/*#__PURE__*/_jsx(Pagination.Item,{active:i===currentPage,onClick:()=>handlePageChange(i),children:i},i));}if(endPage<totalPages-1){pageItems.push(/*#__PURE__*/_jsx(Pagination.Ellipsis,{},\"ellipsis-end\"));}// 最後一頁\npageItems.push(/*#__PURE__*/_jsx(Pagination.Item,{active:currentPage===totalPages,onClick:()=>handlePageChange(totalPages),children:totalPages},totalPages));}return pageItems;};useEffect(()=>{// 設置頁面特定的 padding-bottom\ndocument.body.classList.add('no-padding-bottom');return()=>{// 清除特定頁面的 padding-bottom\ndocument.body.classList.remove('no-padding-bottom');};},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[!loading&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"comicRead no-padding-bottom\",children:[/*#__PURE__*/_jsxs(Navbar,{className:`comic-custom-navbar ${showNavbar?'show':'hide'}`,expand:\"lg\",children:[/*#__PURE__*/_jsx(Navbar.Brand,{className:\"navbar-left\",children:/*#__PURE__*/_jsx(Link,{to:`/comicDetail/${comicID}`,children:/*#__PURE__*/_jsx(ChevronLeft,{className:\"icon\",size:36})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"navbar-center\",children:[t('第幾章',{chapter:(_chapter$=chapter[0])===null||_chapter$===void 0?void 0:_chapter$.num}),\"\\uFF1A \",(_chapter$2=chapter[0])===null||_chapter$2===void 0?void 0:_chapter$2.chapterTitle]}),/*#__PURE__*/_jsx(\"div\",{className:\"navbar-right\",children:/*#__PURE__*/_jsx(List,{className:\"icon\",size:36,onClick:handleListClick})})]}),pageMode?splitImages.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"flip-comic\",...swipeHandlers,onClick:handleClick,children:/*#__PURE__*/_jsx(\"img\",{src:splitImages[readPage].image,alt:\"Page comics\",className:\"split-image active\",style:{zIndex:2}},splitImages[readPage].id)}):chapter.map((chapter,index)=>/*#__PURE__*/_jsx(\"div\",{onClick:handleClick,className:\"banner-image\",children:/*#__PURE__*/_jsx(\"img\",{src:chapter.image,alt:\"Long Banner\"})},index)),/*#__PURE__*/_jsxs(\"div\",{className:`icon-bar ${showIconBar?'show':'hide'}`,children:[/*#__PURE__*/_jsx(ChevronDoubleLeft,{onClick:handleClickLeft,className:\"icon\"}),pageMode?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ChevronLeft,{className:\"icon\",onClick:handlePrev,disabled:readPage===0}),/*#__PURE__*/_jsx(ChevronRight,{className:\"icon\",onClick:handleNext,disabled:readPage===splitImages.length-1})]}):/*#__PURE__*/_jsx(\"div\",{style:{marginRight:\"100px\"}}),/*#__PURE__*/_jsx(ChevronDoubleRight,{onClick:handleClickRight,className:\"icon\"})]}),showOverlay&&/*#__PURE__*/_jsx(\"div\",{className:\" comic-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"overlay-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"overlay-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"overlay-comic-title\",children:(_currentChapters$=currentChapters[0])===null||_currentChapters$===void 0?void 0:_currentChapters$.comicTitle}),/*#__PURE__*/_jsx(\"div\",{className:\"overlay-author-title\",children:(_currentChapters$2=currentChapters[0])===null||_currentChapters$2===void 0?void 0:_currentChapters$2.creator}),/*#__PURE__*/_jsx(\"button\",{className:\"overlay-close\",onClick:handleCloseOverlay,children:\"\\u2715\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:toggleMode,className:\"toggleMode-button\",children:[t('切換模式：'),pageMode?t('條漫'):t('頁漫')]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"overlay-divider\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overlay-body\",children:/*#__PURE__*/_jsx(Row,{className:\"justify-content-center\",children:/*#__PURE__*/_jsx(Col,{className:\"d-flex justify-content-center chapter-table\",children:/*#__PURE__*/_jsx(Table,{size:\"sm\",children:/*#__PURE__*/_jsx(\"tbody\",{children:currentChapters.map((chapter,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"text-center fw-bold\",children:t('第幾章',{chapter:startIndex+index+1})}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:chapter.chapterTitle}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:chapter.chapterPrice}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlePurchase(index),className:`btn ${chapter.isBuying===t('閱讀')?'read-button':'buy-button'}`,value:chapter.isBuying,children:chapter.isBuying})})]},index))})})})})})]})})]})}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading-container\",children:/*#__PURE__*/_jsx(\"div\",{children:t('頁面加載中')})})]});};export default ComicRead;","map":{"version":3,"names":["React","useState","useEffect","useRef","Link","useParams","Navbar","Container","Row","Col","Table","ButtonToolbar","Pagination","ChevronLeft","List","ChevronDoubleLeft","ChevronRight","ChevronDoubleRight","useSwipeable","message","comicData","Web3","useTranslation","i18n","axios","sortByTimestamp","getTransactionTimestamp","disableAllButtons","enableAllButtons","initializeWeb3","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","website","process","env","REACT_APP_Website","API_KEY","REACT_APP_API_KEY","ComicRead","_chapter$","_chapter$2","_currentChapters$","_currentChapters$2","showNavbar","setShowNavbar","showIconBar","setShowIconBar","lastScrollTop","showOverlay","setShowOverlay","comic","setComic","allChapters","setAllChapters","chapter","setChapter","splitImages","setSplitImages","autoMode","setAutoMode","pageMode","setPageMode","comicID","chapterID","loading","setLoading","currentPage","setCurrentPage","readPage","setReadPage","itemsPerPage","t","storedArrayJSON","localStorage","getItem","currentAccount","readingProgress","setReadingProgress","savedProgress","JSON","parse","headers","fetchedData","temp","read","handleScroll","currentScrollTop","window","pageYOffset","document","documentElement","scrollTop","current","handleClick","prevState","handleListClick","handleCloseOverlay","addEventListener","removeEventListener","handlePageChange","page","initData","storedArray","i","length","push","response","get","params","comicHash","comic_id","records","data","map","index","isBuying","creator","chapterPrice","chapterResponse","chapterHash","responseType","image","URL","createObjectURL","img","Image","src","crossOrigin","Promise","resolve","onload","width","processImage","chapterTitle","num","error","console","prevProgress","newProgress","setItem","stringify","splitWidth","numSplits","Math","ceil","canvas","createElement","context","getContext","newSplitImages","height","clearRect","drawImage","splitImageURL","toDataURL","id","handlePurchase","chapterId","currentChapters","operationValue","location","href","web3","web3Instance","eth","Contract","abi","address","accounts","getAccounts","account","balance","getBalance","toString","price","utils","toWei","gasEstimate","methods","purchaseChapter","estimateGas","from","value","transaction","send","gas","transactionHash","Timestamp","author","formData","FormData","append","post","info","updatedChapters","alert","includes","reload","handleClickLeft","total","parseInt","replace","handleClickRight","handlePrev","handleNext","swipeHandlers","onSwipedLeft","onSwipedRight","preventDefaultTouchmoveEvent","trackMouse","toggleMode","prevMode","totalPages","startIndex","slice","getPageItems","pageItems","maxPagesToShow","Item","active","onClick","children","middlePages","floor","startPage","max","endPage","min","Ellipsis","body","classList","add","remove","className","expand","Brand","to","size","alt","style","zIndex","disabled","marginRight","comicTitle"],"sources":["C:/Users/user1/Desktop/blockchain-comics-platform/frontend/src/routes/comicRead.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { Link, useParams } from \"react-router-dom\";\r\nimport { Navbar, Container, Row, Col, Table, ButtonToolbar, Pagination } from 'react-bootstrap';\r\nimport { ChevronLeft, List, ChevronDoubleLeft, ChevronRight, ChevronDoubleRight } from 'react-bootstrap-icons';\r\nimport { useSwipeable } from 'react-swipeable';\r\nimport { message } from 'antd';\r\nimport comicData from '../contracts/ComicPlatform.json';\r\nimport Web3 from 'web3';\r\nimport { useTranslation } from 'react-i18next';\r\nimport i18n from '../i18n';\r\nimport axios from 'axios';\r\nimport { sortByTimestamp, getTransactionTimestamp, disableAllButtons, enableAllButtons, initializeWeb3 } from '../index';\r\nconst website = process.env.REACT_APP_Website;\r\nconst API_KEY = process.env.REACT_APP_API_KEY;\r\n\r\nconst ComicRead = () => {\r\n    const [showNavbar, setShowNavbar] = useState(true);\r\n    const [showIconBar, setShowIconBar] = useState(true);\r\n    const lastScrollTop = useRef(0);\r\n    const [showOverlay, setShowOverlay] = useState(false);\r\n    const [comic, setComic] = useState([]);\r\n    const [allChapters, setAllChapters] = useState([]);\r\n    const [chapter, setChapter] = useState([]);\r\n    const [splitImages, setSplitImages] = useState([]);\r\n    const [autoMode, setAutoMode] = useState(true);\r\n    const [pageMode, setPageMode] = useState('');\r\n    const { comicID, chapterID } = useParams();\r\n    const [loading, setLoading] = useState(true);\r\n    const [currentPage, setCurrentPage] = useState(1);\r\n    const [readPage, setReadPage] = useState(0);\r\n    const itemsPerPage = 10; // 每頁顯示的章節數量\r\n    const { t } = useTranslation();\r\n    const storedArrayJSON = localStorage.getItem('comicDatas');\r\n    const currentAccount = localStorage.getItem(\"currentAccount\");\r\n    const [readingProgress, setReadingProgress] = useState(() => {\r\n        const savedProgress = localStorage.getItem('readingProgress');\r\n        return savedProgress ? JSON.parse(savedProgress) : {};\r\n    });\r\n    const headers = {'api-key': API_KEY};\r\n    const fetchedData = [];\r\n    let temp = [];\r\n    let read = [];\r\n\r\n    const handleScroll = () => {\r\n        const currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;\r\n        if (currentScrollTop > lastScrollTop.current) {\r\n            // 向下滚动\r\n            setShowNavbar(false);\r\n            setShowIconBar(false);\r\n        } else {\r\n            // 向上滚动\r\n            setShowNavbar(true);\r\n            setShowIconBar(true);\r\n        }\r\n        lastScrollTop.current = currentScrollTop <= 0 ? 0 : currentScrollTop;\r\n    };\r\n\r\n    const handleClick = () => {\r\n        setShowNavbar(prevState => !prevState);\r\n        setShowIconBar(prevState => !prevState);\r\n    };\r\n\r\n    const handleListClick = () => {\r\n        setShowOverlay(true);\r\n    };\r\n\r\n    const handleCloseOverlay = () => {\r\n        setShowOverlay(false);\r\n    };\r\n\r\n    useEffect(() => {\r\n        window.addEventListener('scroll', handleScroll);\r\n\r\n        return () => {\r\n            window.removeEventListener('scroll', handleScroll);\r\n        };\r\n    }, []);\r\n\r\n\r\n    const handlePageChange = (page) => {\r\n        setCurrentPage(page);\r\n    };\r\n\r\n    const initData = async () => {\r\n        try {\r\n            const storedArray = JSON.parse(storedArrayJSON);\r\n            for (var i = 0; i < storedArray.length; i++) {\r\n              if(storedArray[i].comicID == comicID){\r\n                temp.push(storedArray[i]);\r\n              };\r\n            };\r\n            setComic(temp);\r\n            // 本漫畫的所有章節是否購買\r\n            try {\r\n                const response = await axios.get(`${website}/api/comicRead`, {\r\n                    headers: headers,\r\n                    params: {\r\n                        comicHash: temp[0].comic_id,\r\n                        currentAccount: currentAccount\r\n                    }\r\n                });\r\n                let records = response.data;\r\n                sortByTimestamp(records);\r\n\r\n                records = records.map((chapter, index) => {\r\n                    let isBuying, creator, chapterPrice;\r\n                    if (chapter.creator === currentAccount) {\r\n                        isBuying = t('閱讀');\r\n                        creator = t('您是本作品的創作者');\r\n                        if (chapter.chapterPrice == 0) {\r\n                            chapterPrice = t('免費');\r\n                        } else {\r\n                            chapterPrice = chapter.chapterPrice;\r\n                        }\r\n                    } else if (chapter.chapterPrice == 0) {\r\n                        isBuying = t('閱讀');\r\n                        creator = chapter.creator\r\n                        chapterPrice = t('免費');\r\n                    } else {\r\n                        isBuying = t(chapter.isBuying);\r\n                        creator = chapter.creator;\r\n                        chapterPrice = chapter.chapterPrice;\r\n                    }\r\n                    return {\r\n                        ...chapter,\r\n                        chapterID: `chapter${index + 1}`,\r\n                        isBuying,\r\n                        creator,\r\n                        chapterPrice\r\n                    };\r\n                });\r\n                setAllChapters(records);\r\n\r\n                for (var i = 0; i < records.length; i++) {\r\n                    if (records[i].chapterID === chapterID && records[i].isBuying === t('閱讀')) {\r\n                        const chapterResponse = await axios.get(`${website}/api/chapterIMG/${records[i].chapterHash}`, { responseType: 'blob', headers });\r\n                        const image = URL.createObjectURL(chapterResponse.data);\r\n                        const img = new Image();\r\n                        img.src = image;\r\n                        img.crossOrigin = 'Anonymous'; // 避免 CORS 问题\r\n                        await new Promise((resolve) => {\r\n                            img.onload = resolve;\r\n                        });\r\n                        if (autoMode) {\r\n                            if (img.width >= 1200) {\r\n                                setSplitImages(processImage(img));\r\n                                setPageMode(true);\r\n                            } else {\r\n                                setPageMode(false);\r\n                            }\r\n                        } else if (pageMode) {\r\n                            setSplitImages(processImage(img));\r\n                        }\r\n                        read.push({\r\n                            chapterTitle: records[i].chapterTitle,\r\n                            chapterID: chapterID,\r\n                            num: (i+1),\r\n                            image: image\r\n                        });\r\n                    }\r\n                }\r\n                setChapter(read);\r\n                setLoading(false);\r\n            } catch (error) {\r\n                console.error('Error fetching records:', error);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error initializing contract:', error);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        initData();\r\n        setReadingProgress((prevProgress) => {\r\n            const newProgress = { ...prevProgress, [comicID]: chapterID };\r\n            localStorage.setItem('readingProgress', JSON.stringify(newProgress));\r\n            return newProgress;\r\n        });\r\n    }, [comicID, chapterID, autoMode]);\r\n\r\n    const processImage = (img) => {\r\n        const splitWidth = 1200;\r\n        const numSplits = Math.ceil(img.width / splitWidth);\r\n        const canvas = document.createElement('canvas');\r\n        const context = canvas.getContext('2d');\r\n        const newSplitImages = [];\r\n        for (let i = 0; i < numSplits; i++) {\r\n            canvas.width = splitWidth;\r\n            canvas.height = img.height;\r\n            context.clearRect(0, 0, canvas.width, canvas.height);\r\n            context.drawImage(img, -i * splitWidth, 0);\r\n            const splitImageURL = canvas.toDataURL('image/png');\r\n            newSplitImages.push({\r\n                id: i + 1,\r\n                image: splitImageURL,\r\n            });\r\n        };\r\n        return newSplitImages;\r\n    }\r\n\r\n    // 章節購買 或 閱讀函數\r\n    const handlePurchase = async (chapterId) => {\r\n        const chapter = currentChapters[chapterId]; // 使用傳遞進來的索引值來訪問章節資料\r\n        const operationValue = chapter.isBuying;\r\n\r\n        if (operationValue === t('閱讀')) {\r\n        window.location.href = `/comicRead/${comicID}/${chapter.chapterID}`;\r\n        } else {\r\n            try {\r\n                disableAllButtons();\r\n                const web3 = await initializeWeb3(t);\r\n                if (!web3) {\r\n                    return;\r\n                }\r\n                const web3Instance = new web3.eth.Contract(comicData.abi, comicData.address);\r\n                const accounts = await web3.eth.getAccounts();\r\n                const account = accounts[0];\r\n                if (account) {\r\n                    let balance = await web3.eth.getBalance(currentAccount);\r\n                    balance = balance.toString() / 1e18;\r\n                    let price = chapter.chapterPrice;\r\n                    if (balance > price) {\r\n                        const comicHash = comic[0].comic_id;\r\n                        const chapterHash = chapter.chapterHash;\r\n                        //console.log(comicHash);\r\n                        //console.log(comic[0].creator);\r\n                        //console.log(chapterHash);\r\n                        //console.log(price);\r\n                        price = web3.utils.toWei(price, 'ether');\r\n\r\n                        let gasEstimate = await web3Instance.methods.purchaseChapter(comicHash, chapterHash, price/10).estimateGas({\r\n                            from: currentAccount,\r\n                            value: price,\r\n                        });\r\n                        const transaction = await web3Instance.methods.purchaseChapter(comicHash, chapterHash, gasEstimate).send({\r\n                            from: currentAccount,\r\n                            value: price,\r\n                            gas: gasEstimate\r\n                        });\r\n                        const transactionHash = transaction.transactionHash;\r\n                        let Timestamp = await getTransactionTimestamp(transactionHash);\r\n\r\n                        const author = comic[0].creator\r\n                        const formData = new FormData();\r\n                        formData.append('hash', transactionHash);\r\n                        formData.append('comic_id', comicHash);\r\n                        formData.append('chapter_id', chapterHash);\r\n                        formData.append('buyer', currentAccount);\r\n                        formData.append('creator', author);\r\n                        formData.append('purchase_date', Timestamp);\r\n                        formData.append('price', chapter.chapterPrice);\r\n                        try {\r\n                            const response = await axios.post(`${website}/api/add/records`, formData, {\r\n                            headers: {\r\n                                'Content-Type': 'multipart/form-data',\r\n                                'api-key': API_KEY\r\n                            }\r\n                            });\r\n                            message.info(t('章節購買成功'));\r\n                            const updatedChapters = [...currentChapters];\r\n                            updatedChapters[chapterId].isBuying = t('閱讀'); // 更新章節的購買狀態\r\n                            setAllChapters(updatedChapters);\r\n                        } catch (error) {\r\n                            console.error('購買紀錄添加至資料庫時發生錯誤：', error);\r\n                        }\r\n                    } else {\r\n                        message.info(t('餘額不足'));\r\n                    }\r\n                } else {\r\n                    alert(t('請先登入以太坊錢包，再進行購買'));\r\n                    return;\r\n                }\r\n            } catch (error) {\r\n                if (error.message.includes('User denied transaction signature')) {\r\n                    alert(t('拒绝交易'));\r\n                  } else {\r\n                    console.error('章節購買時發生錯誤：', error);\r\n                    alert(error);\r\n                    window.location.reload();\r\n                  }\r\n            } finally {\r\n                enableAllButtons();\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleClickLeft = () => {\r\n        const total = allChapters.length.toString();\r\n        let id = parseInt(chapterID.replace(\"chapter\", \"\"), 10);\r\n        if (total == 1) {\r\n            message.info(t('目前只有這個章節'));\r\n            return;\r\n        } else if (allChapters[(id-2)]) {\r\n            if (allChapters[(id-2)].isBuying === t('閱讀')) {\r\n                window.location.replace(`/comicRead/${comicID}/chapter${id-1}`);\r\n            } else {\r\n                message.info(t('您尚未購買第幾章節', { id: id - 1 }));\r\n                return;\r\n            }\r\n        } else {\r\n            message.info(t('本章節為第一章'));\r\n            return;\r\n        }\r\n    };\r\n\r\n    const handleClickRight = () => {\r\n        const total = allChapters.length.toString();\r\n        let id = parseInt(chapterID.replace(\"chapter\", \"\"), 10);\r\n\r\n        if (total == 1) {\r\n            message.info(t('目前只有這個章節'));\r\n            return;\r\n        } else if (allChapters[(id)]) {\r\n            if (allChapters[(id)].isBuying === t('閱讀')) {\r\n                window.location.replace(`/comicRead/${comicID}/chapter${id+1}`);\r\n            } else {\r\n                message.info(t('您尚未購買第幾章節', { id: id + 1 }));\r\n                return;\r\n            }\r\n        } else {\r\n            message.info(t('本章節為最新章'));\r\n            return;\r\n        }\r\n    };\r\n\r\n    const handlePrev = () => {\r\n        if (readPage > 0) {\r\n            setReadPage(readPage - 1);\r\n        } else if (readPage == 0) {\r\n            message.info(t('此為第一頁'));\r\n        }\r\n    };\r\n\r\n    const handleNext = () => {\r\n        if (readPage < splitImages.length - 1) {\r\n            setReadPage(readPage + 1);\r\n        } else if (readPage == splitImages.length-1) {\r\n            message.info(t('本章節已閱讀完'));\r\n        }\r\n    };\r\n\r\n    const swipeHandlers = useSwipeable({\r\n        onSwipedLeft: handleNext,\r\n        onSwipedRight: handlePrev,\r\n        preventDefaultTouchmoveEvent: true,\r\n        trackMouse: true,\r\n    });\r\n\r\n    const toggleMode = () => {\r\n        setPageMode((prevMode) => !prevMode);\r\n        setAutoMode(false);\r\n    };\r\n    \r\n    const totalPages = Math.ceil(allChapters.length / itemsPerPage);\r\n    const startIndex = (currentPage - 1) * itemsPerPage;\r\n    const currentChapters = allChapters.slice(startIndex, startIndex + itemsPerPage);\r\n\r\n    const getPageItems = () => {\r\n        const pageItems = [];\r\n        const maxPagesToShow = 5; // 顯示的最大頁碼數量\r\n    \r\n        if (totalPages <= maxPagesToShow) {\r\n            // 如果總頁數小於等於最大顯示頁碼數，則顯示所有頁碼\r\n            for (let i = 1; i <= totalPages; i++) {\r\n                pageItems.push(\r\n                    <Pagination.Item key={i} active={i === currentPage} onClick={() => handlePageChange(i)}>\r\n                        {i}\r\n                    </Pagination.Item>\r\n                );\r\n            }\r\n        } else {\r\n            // 計算中間的頁碼範圍\r\n            const middlePages = Math.floor(maxPagesToShow / 2);\r\n            let startPage = Math.max(2, currentPage - middlePages);\r\n            let endPage = Math.min(totalPages - 1, currentPage + middlePages);\r\n    \r\n            if (currentPage - startPage <= middlePages) {\r\n                endPage = Math.min(totalPages - 1, startPage + maxPagesToShow - 2);\r\n            }\r\n    \r\n            if (endPage - currentPage <= middlePages) {\r\n                startPage = Math.max(2, endPage - maxPagesToShow + 2);\r\n            }\r\n    \r\n            // 第一頁\r\n            pageItems.push(\r\n                <Pagination.Item key={1} active={currentPage === 1} onClick={() => handlePageChange(1)}>\r\n                    1\r\n                </Pagination.Item>\r\n            );\r\n    \r\n            if (startPage > 2) {\r\n                pageItems.push(<Pagination.Ellipsis key=\"ellipsis-start\" />);\r\n            }\r\n    \r\n            // 中間的頁碼\r\n            for (let i = startPage; i <= endPage; i++) {\r\n                pageItems.push(\r\n                    <Pagination.Item key={i} active={i === currentPage} onClick={() => handlePageChange(i)}>\r\n                        {i}\r\n                    </Pagination.Item>\r\n                );\r\n            }\r\n    \r\n            if (endPage < totalPages - 1) {\r\n                pageItems.push(<Pagination.Ellipsis key=\"ellipsis-end\" />);\r\n            }\r\n    \r\n            // 最後一頁\r\n            pageItems.push(\r\n                <Pagination.Item key={totalPages} active={currentPage === totalPages} onClick={() => handlePageChange(totalPages)}>\r\n                    {totalPages}\r\n                </Pagination.Item>\r\n            );\r\n        }\r\n    \r\n        return pageItems;\r\n    };\r\n\r\n    useEffect(() => {\r\n        // 設置頁面特定的 padding-bottom\r\n        document.body.classList.add('no-padding-bottom');\r\n        return () => {\r\n          // 清除特定頁面的 padding-bottom\r\n        document.body.classList.remove('no-padding-bottom');\r\n        };\r\n    }, []);\r\n\r\n\r\n    \r\n\r\n\r\n    return (\r\n        <>\r\n        {!loading && (\r\n            <>\r\n                <div className='comicRead no-padding-bottom'>\r\n                    <Navbar className={`comic-custom-navbar ${showNavbar ? 'show' : 'hide'}`} expand=\"lg\">\r\n                        <Navbar.Brand className=\"navbar-left\">\r\n                            <Link to={`/comicDetail/${comicID}`}>\r\n                                <ChevronLeft className=\"icon\" size={36} />\r\n                            </Link>\r\n                        </Navbar.Brand>\r\n                        <div className=\"navbar-center\">\r\n                            {t('第幾章', { chapter: chapter[0]?.num })}： {chapter[0]?.chapterTitle}\r\n                        </div>\r\n                        <div className=\"navbar-right\">\r\n                            <List className=\"icon\" size={36} onClick={handleListClick} />\r\n                        </div>\r\n                    </Navbar>\r\n                    {pageMode ? (\r\n                        splitImages.length > 0 && (\r\n                            <div\r\n                                className=\"flip-comic\"\r\n                                {...swipeHandlers}\r\n                                onClick={handleClick}\r\n                            >\r\n                                <img\r\n                                    key={splitImages[readPage].id}\r\n                                    src={splitImages[readPage].image}\r\n                                    alt=\"Page comics\"\r\n                                    className=\"split-image active\"\r\n                                    style={{ zIndex: 2 }}\r\n                                />\r\n                            </div>\r\n                        )\r\n                    ) : (\r\n                        chapter.map((chapter, index) => (\r\n                            <div key={index} onClick={handleClick} className=\"banner-image\">\r\n                                <img src={chapter.image} alt=\"Long Banner\" />\r\n                            </div>\r\n                        ))\r\n                    )}\r\n                    <div className={`icon-bar ${showIconBar ? 'show' : 'hide'}`}>\r\n                        <ChevronDoubleLeft onClick={handleClickLeft} className=\"icon\" />\r\n                        {pageMode ? (\r\n                            <>\r\n                                <ChevronLeft className=\"icon\" onClick={handlePrev} disabled={readPage === 0} />\r\n                                <ChevronRight className=\"icon\" onClick={handleNext} disabled={readPage === splitImages.length - 1}/>\r\n                            </>\r\n                        ) : (\r\n                            <div style={{marginRight: \"100px\"}}></div>\r\n                        )}\r\n                        <ChevronDoubleRight onClick={handleClickRight} className=\"icon\" />\r\n                    </div>\r\n        \r\n                    {showOverlay && (\r\n                        <div className=\" comic-overlay\">\r\n                            <div className=\"overlay-content\">\r\n                                <div className=\"overlay-header\">\r\n                                    <div className=\"overlay-comic-title\">{currentChapters[0]?.comicTitle}</div>\r\n                                    <div className=\"overlay-author-title\">{currentChapters[0]?.creator}</div>\r\n                                    <button className=\"overlay-close\" onClick={handleCloseOverlay}>✕</button>\r\n                                    <button onClick={toggleMode} className=\"toggleMode-button\">\r\n                                        {t('切換模式：')}{pageMode ? t('條漫') : t('頁漫')}\r\n                                    </button>\r\n                                </div>\r\n                                <div className=\"overlay-divider\"></div>\r\n                                <div className=\"overlay-body\">\r\n                                    <Row className='justify-content-center'>\r\n                                        <Col className='d-flex justify-content-center chapter-table'>\r\n                                            <Table size=\"sm\">\r\n                                                <tbody>\r\n                                                    {currentChapters.map((chapter, index) => (\r\n                                                        <tr key={index}>\r\n                                                            <td className='text-center fw-bold'>{t('第幾章', { chapter: startIndex + index + 1 })}</td>\r\n                                                            <td className='text-center'>{chapter.chapterTitle}</td>\r\n                                                            <td className='text-center'>{chapter.chapterPrice}</td>\r\n                                                            <td className='text-center'>\r\n                                                                <button onClick={() => handlePurchase(index)} className={`btn ${chapter.isBuying === t('閱讀') ? 'read-button' : 'buy-button'}`} value={chapter.isBuying}>{chapter.isBuying}</button>\r\n                                                            </td>\r\n                                                        </tr>\r\n                                                    ))}\r\n                                                </tbody>\r\n                                            </Table>\r\n                                        </Col>\r\n                                    </Row>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </>\r\n        )}\r\n    \r\n        {loading &&  \r\n            <div className=\"loading-container\">\r\n                <div>{t('頁面加載中')}</div>\r\n            </div>\r\n        }\r\n        </>\r\n    );\r\n};\r\n\r\nexport default ComicRead;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}