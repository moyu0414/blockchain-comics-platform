{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link}from\"react-router-dom\";import{Container,Col,Row,Image,Button}from'react-bootstrap';import'./bootstrap.min.css';import{useTranslation}from'react-i18next';import i18n from'../i18n';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const website=process.env.REACT_APP_Website;const API_KEY=process.env.REACT_APP_API_KEY;function EditSuccess(){const[comic,setComic]=useState([]);const[loading,setLoading]=useState(true);const{t}=useTranslation();const editComicData=localStorage.getItem(\"editComicData\");const editArray=JSON.parse(editComicData);const currentAccount=localStorage.getItem(\"currentAccount\");const headers={'api-key':API_KEY};let temp=[];const initData=async()=>{try{//console.log(editArray);\nconst comicHash=editArray.comicHash;const editTitle=editArray.editTitle;const editChapter=editArray.editChapter;let found=false;while(!found){const storedArrayJSON=localStorage.getItem('comicDatas');const storedArray=JSON.parse(storedArrayJSON);for(let i=0;i<storedArray.length;i++){if(comicHash===storedArray[i].comic_id){const imageResponse=await axios.get(`${website}/api/comicIMG/${storedArray[i].comic_id}`,{responseType:'blob',headers});const image=URL.createObjectURL(imageResponse.data);temp.push({comicID:storedArray[i].comicID,title:editTitle,image:image,editChapter:editChapter});found=true;// 找到匹配的条件或者不需要等待，可以退出循环\nbreak;}}if(!found){await new Promise(resolve=>setTimeout(resolve,1000));// 等待1秒钟再尝试\n}}//console.log(temp);\nsetComic(temp);setLoading(false);}catch(error){console.error('Error initializing contract:',error);}};useEffect(()=>{initData();},[currentAccount]);const handleCreator=()=>{window.location.replace(\"/creatorPage\");};const handleMGMT=()=>{window.location.replace(\"/manageComic\");};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{children:[!loading&&/*#__PURE__*/_jsxs(Container,{className:\"createSuccess\",children:[/*#__PURE__*/_jsx(Row,{className:\"pt-4\",children:/*#__PURE__*/_jsxs(Link,{to:`/comicDetail/${comic[0].comicID}`,children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-block mx-auto img-fluid createSuccess-image-container\",children:/*#__PURE__*/_jsx(\"img\",{className:\"d-block mx-auto img-fluid\",src:comic[0].image,alt:\"800x400\"})}),/*#__PURE__*/_jsx(\"h5\",{className:\"text-center pt-2 pb-1\",children:comic[0].title}),/*#__PURE__*/_jsx(\"h5\",{className:\"text-center pb-3\",children:comic[0].editChapter})]})}),/*#__PURE__*/_jsx(Row,{className:\"justify-content-center text-center w-100\",children:/*#__PURE__*/_jsxs(Col,{xs:12,md:8,children:[/*#__PURE__*/_jsx(Image,{src:\"/Emoji.png\",alt:\"\\u5716\\u7247\",fluid:true,rounded:true,className:\"mb-4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"h4\",{children:t('漫畫編輯成功')})}),/*#__PURE__*/_jsx(Button,{onClick:handleCreator,style:{marginRight:\"15px\"},children:t('創作者專區')}),/*#__PURE__*/_jsx(Button,{onClick:handleMGMT,children:t('管理漫畫')})]})})]}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading-container\",children:/*#__PURE__*/_jsx(\"div\",{children:t('頁面加載中')})})]})});}export default EditSuccess;","map":{"version":3,"names":["React","useState","useEffect","Link","Container","Col","Row","Image","Button","useTranslation","i18n","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","website","process","env","REACT_APP_Website","API_KEY","REACT_APP_API_KEY","EditSuccess","comic","setComic","loading","setLoading","t","editComicData","localStorage","getItem","editArray","JSON","parse","currentAccount","headers","temp","initData","comicHash","editTitle","editChapter","found","storedArrayJSON","storedArray","i","length","comic_id","imageResponse","get","responseType","image","URL","createObjectURL","data","push","comicID","title","Promise","resolve","setTimeout","error","console","handleCreator","window","location","replace","handleMGMT","children","className","to","src","alt","xs","md","fluid","rounded","onClick","style","marginRight"],"sources":["C:/Users/user1/Desktop/blockchain-comics-platform/frontend/src/routes/editSuccess.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Link } from \"react-router-dom\";\r\nimport { Container, Col, Row, Image, Button } from 'react-bootstrap';\r\nimport './bootstrap.min.css';\r\nimport { useTranslation } from 'react-i18next';\r\nimport i18n from '../i18n';\r\nimport axios from 'axios';\r\nconst website = process.env.REACT_APP_Website;\r\nconst API_KEY = process.env.REACT_APP_API_KEY;\r\n\r\nfunction EditSuccess() {\r\n    const [comic, setComic] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const { t } = useTranslation();\r\n    const editComicData = localStorage.getItem(\"editComicData\");\r\n    const editArray = JSON.parse(editComicData);\r\n    const currentAccount = localStorage.getItem(\"currentAccount\");\r\n    const headers = {'api-key': API_KEY};\r\n    let temp = [];\r\n\r\n    const initData = async () => {\r\n        try {\r\n            //console.log(editArray);\r\n            const comicHash = editArray.comicHash;\r\n            const editTitle = editArray.editTitle;\r\n            const editChapter = editArray.editChapter;\r\n            let found = false;\r\n            while (!found) {\r\n                const storedArrayJSON = localStorage.getItem('comicDatas');\r\n                const storedArray = JSON.parse(storedArrayJSON);\r\n                for (let i = 0; i < storedArray.length; i++) {\r\n                    if (comicHash === storedArray[i].comic_id) {\r\n                        const imageResponse = await axios.get(`${website}/api/comicIMG/${storedArray[i].comic_id}`, { responseType: 'blob', headers });\r\n                        const image = URL.createObjectURL(imageResponse.data);\r\n                        temp.push({\r\n                            comicID: storedArray[i].comicID,\r\n                            title: editTitle,\r\n                            image: image,\r\n                            editChapter: editChapter\r\n                        });\r\n                        found = true; // 找到匹配的条件或者不需要等待，可以退出循环\r\n                        break;\r\n                    }\r\n                }\r\n                if (!found) {\r\n                    await new Promise(resolve => setTimeout(resolve, 1000)); // 等待1秒钟再尝试\r\n                }\r\n            }\r\n            //console.log(temp);\r\n            setComic(temp);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('Error initializing contract:', error);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        initData();\r\n    }, [currentAccount]);\r\n\r\n    const handleCreator = () => {\r\n        window.location.replace(\"/creatorPage\");\r\n    };\r\n\r\n    const handleMGMT = () => {\r\n        window.location.replace(\"/manageComic\");\r\n    };\r\n\r\n\r\n    return (\r\n        <>\r\n            <div>\r\n                {!loading &&\r\n                    <Container className='createSuccess'>\r\n                        {/* 此處會放上該漫畫的封面+名稱供預覽 跟創作者頁面creatorPage的一樣*/}\r\n                        <Row className=\"pt-4\">\r\n                            <Link to={`/comicDetail/${comic[0].comicID}`}>\r\n                                <div className=\"d-block mx-auto img-fluid createSuccess-image-container\">\r\n                                    <img\r\n                                    className=\"d-block mx-auto img-fluid\"\r\n                                    src={comic[0].image}\r\n                                    alt=\"800x400\"\r\n                                    />\r\n                                </div>\r\n                                <h5 className='text-center pt-2 pb-1'>{comic[0].title}</h5>\r\n                                <h5 className='text-center pb-3'>{comic[0].editChapter}</h5>\r\n                            </Link>\r\n                        </Row>\r\n                        <Row className=\"justify-content-center text-center w-100\">\r\n                            <Col xs={12} md={8}>\r\n                                <Image \r\n                                src=\"/Emoji.png\"\r\n                                alt=\"圖片\" \r\n                                fluid \r\n                                rounded \r\n                                className=\"mb-4\" \r\n                            />\r\n                            <div className=\"mb-3\">\r\n                                <h4>{t('漫畫編輯成功')}</h4>\r\n                            </div>\r\n                            <Button onClick={handleCreator} style={{marginRight: \"15px\"}}>{t('創作者專區')}</Button>\r\n                            <Button onClick={handleMGMT}>{t('管理漫畫')}</Button>\r\n                            </Col>\r\n                        </Row>\r\n                    </Container>\r\n                }\r\n                {loading &&  \r\n                    <div className=\"loading-container\">\r\n                        <div>{t('頁面加載中')}</div>\r\n                    </div>\r\n                }\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default EditSuccess;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}